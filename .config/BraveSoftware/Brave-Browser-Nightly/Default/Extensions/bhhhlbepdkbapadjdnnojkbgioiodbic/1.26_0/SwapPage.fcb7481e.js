"use strict";(self.webpackChunksolflare=self.webpackChunksolflare||[]).push([["SwapPage"],{"./node_modules/@material-ui/core/esm/LinearProgress/LinearProgress.js":function(e,t,n){var r=n("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=n("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),s=n("./node_modules/react/index.js"),o=n("./node_modules/clsx/dist/clsx.m.js"),i=n("./node_modules/@material-ui/core/esm/utils/capitalize.js"),c=n("./node_modules/@material-ui/core/esm/styles/withStyles.js"),l=n("./node_modules/@material-ui/core/esm/styles/colorManipulator.js"),u=n("./node_modules/@material-ui/core/esm/styles/useTheme.js"),m=s.forwardRef((function(e,t){var n=e.classes,c=e.className,l=e.color,m=void 0===l?"primary":l,p=e.value,d=e.valueBuffer,f=e.variant,y=void 0===f?"indeterminate":f,h=(0,a.Z)(e,["classes","className","color","value","valueBuffer","variant"]),g=(0,u.Z)(),b={},w={bar1:{},bar2:{}};if(("determinate"===y||"buffer"===y)&&void 0!==p){b["aria-valuenow"]=Math.round(p),b["aria-valuemin"]=0,b["aria-valuemax"]=100;var v=p-100;"rtl"===g.direction&&(v=-v),w.bar1.transform="translateX(".concat(v,"%)")}if("buffer"===y&&void 0!==d){var x=(d||0)-100;"rtl"===g.direction&&(x=-x),w.bar2.transform="translateX(".concat(x,"%)")}return s.createElement("div",(0,r.Z)({className:(0,o.Z)(n.root,n["color".concat((0,i.Z)(m))],c,{determinate:n.determinate,indeterminate:n.indeterminate,buffer:n.buffer,query:n.query}[y]),role:"progressbar"},b,{ref:t},h),"buffer"===y?s.createElement("div",{className:(0,o.Z)(n.dashed,n["dashedColor".concat((0,i.Z)(m))])}):null,s.createElement("div",{className:(0,o.Z)(n.bar,n["barColor".concat((0,i.Z)(m))],("indeterminate"===y||"query"===y)&&n.bar1Indeterminate,{determinate:n.bar1Determinate,buffer:n.bar1Buffer}[y]),style:w.bar1}),"determinate"===y?null:s.createElement("div",{className:(0,o.Z)(n.bar,("indeterminate"===y||"query"===y)&&n.bar2Indeterminate,"buffer"===y?[n["color".concat((0,i.Z)(m))],n.bar2Buffer]:n["barColor".concat((0,i.Z)(m))]),style:w.bar2}))}));t.Z=(0,c.Z)((function(e){var t=function(t){return"light"===e.palette.type?(0,l.$n)(t,.62):(0,l._j)(t,.5)},n=t(e.palette.primary.main),r=t(e.palette.secondary.main);return{root:{position:"relative",overflow:"hidden",height:4,"@media print":{colorAdjust:"exact"}},colorPrimary:{backgroundColor:n},colorSecondary:{backgroundColor:r},determinate:{},indeterminate:{},buffer:{backgroundColor:"transparent"},query:{transform:"rotate(180deg)"},dashed:{position:"absolute",marginTop:0,height:"100%",width:"100%",animation:"$buffer 3s infinite linear"},dashedColorPrimary:{backgroundImage:"radial-gradient(".concat(n," 0%, ").concat(n," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},dashedColorSecondary:{backgroundImage:"radial-gradient(".concat(r," 0%, ").concat(r," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},bar:{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},barColorPrimary:{backgroundColor:e.palette.primary.main},barColorSecondary:{backgroundColor:e.palette.secondary.main},bar1Indeterminate:{width:"auto",animation:"$indeterminate1 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite"},bar1Determinate:{transition:"transform .".concat(4,"s linear")},bar1Buffer:{zIndex:1,transition:"transform .".concat(4,"s linear")},bar2Indeterminate:{width:"auto",animation:"$indeterminate2 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite"},bar2Buffer:{transition:"transform .".concat(4,"s linear")},"@keyframes indeterminate1":{"0%":{left:"-35%",right:"100%"},"60%":{left:"100%",right:"-90%"},"100%":{left:"100%",right:"-90%"}},"@keyframes indeterminate2":{"0%":{left:"-200%",right:"100%"},"60%":{left:"107%",right:"-8%"},"100%":{left:"107%",right:"-8%"}},"@keyframes buffer":{"0%":{opacity:1,backgroundPosition:"0 -23px"},"50%":{opacity:0,backgroundPosition:"0 -23px"},"100%":{opacity:1,backgroundPosition:"-200px -23px"}}}}),{name:"MuiLinearProgress"})(m)},"./node_modules/@material-ui/core/esm/Link/Link.js":function(e,t,n){var r=n("./node_modules/@babel/runtime/helpers/esm/extends.js"),a=n("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),s=n("./node_modules/react/index.js"),o=n("./node_modules/clsx/dist/clsx.m.js"),i=n("./node_modules/@material-ui/core/esm/utils/capitalize.js"),c=n("./node_modules/@material-ui/core/esm/styles/withStyles.js"),l=n("./node_modules/@material-ui/core/esm/utils/useIsFocusVisible.js"),u=n("./node_modules/@material-ui/core/esm/utils/useForkRef.js"),m=n("./node_modules/@material-ui/core/esm/Typography/Typography.js"),p=s.forwardRef((function(e,t){var n=e.classes,c=e.className,p=e.color,d=void 0===p?"primary":p,f=e.component,y=void 0===f?"a":f,h=e.onBlur,g=e.onFocus,b=e.TypographyClasses,w=e.underline,v=void 0===w?"hover":w,x=e.variant,S=void 0===x?"inherit":x,Z=(0,a.Z)(e,["classes","className","color","component","onBlur","onFocus","TypographyClasses","underline","variant"]),E=(0,l.Z)(),C=E.isFocusVisible,j=E.onBlurVisible,k=E.ref,_=s.useState(!1),R=_[0],A=_[1],P=(0,u.Z)(t,k);return s.createElement(m.Z,(0,r.Z)({className:(0,o.Z)(n.root,n["underline".concat((0,i.Z)(v))],c,R&&n.focusVisible,"button"===y&&n.button),classes:b,color:d,component:y,onBlur:function(e){R&&(j(),A(!1)),h&&h(e)},onFocus:function(e){C(e)&&A(!0),g&&g(e)},ref:P,variant:S},Z))}));t.Z=(0,c.Z)({root:{},underlineNone:{textDecoration:"none"},underlineHover:{textDecoration:"none","&:hover":{textDecoration:"underline"}},underlineAlways:{textDecoration:"underline"},button:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none","&::-moz-focus-inner":{borderStyle:"none"},"&$focusVisible":{outline:"auto"}},focusVisible:{}},{name:"MuiLink"})(p)},"./node_modules/@material-ui/icons/esm/ExpandLess.js":function(e,t,n){var r=n("./node_modules/react/index.js"),a=n("./node_modules/@material-ui/core/esm/utils/createSvgIcon.js");t.Z=(0,a.Z)(r.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")},"./node_modules/@material-ui/icons/esm/NotInterested.js":function(e,t,n){var r=n("./node_modules/react/index.js"),a=n("./node_modules/@material-ui/core/esm/utils/createSvgIcon.js");t.Z=(0,a.Z)(r.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"NotInterested")},"./node_modules/@material-ui/icons/esm/SyncAlt.js":function(e,t,n){var r=n("./node_modules/react/index.js"),a=n("./node_modules/@material-ui/core/esm/utils/createSvgIcon.js");t.Z=(0,a.Z)(r.createElement("path",{d:"M22 8l-4-4v3H3v2h15v3l4-4zM2 16l4 4v-3h15v-2H6v-3l-4 4z"}),"SyncAlt")},"./src/pages/Swap/index.js":function(e,t,n){n.r(t),n.d(t,{default:function(){return te}});var r,a,s=n("./node_modules/@material-ui/core/esm/Paper/Paper.js"),o=n("./node_modules/@material-ui/core/esm/Tooltip/Tooltip.js"),i=n("./node_modules/@material-ui/icons/esm/HelpOutline.js"),c=n("./node_modules/@material-ui/core/esm/IconButton/IconButton.js"),l=n("./node_modules/@material-ui/core/esm/Divider/Divider.js"),u=n("./node_modules/@material-ui/core/esm/TextField/TextField.js"),m=n("./node_modules/@material-ui/core/esm/InputAdornment/InputAdornment.js"),p=n("./node_modules/@material-ui/core/esm/ButtonBase/ButtonBase.js"),d=n("./node_modules/@material-ui/core/esm/Typography/Typography.js"),f=n("./node_modules/@material-ui/core/esm/Button/Button.js"),y=n("./node_modules/@material-ui/icons/esm/NotInterested.js"),h=n("./node_modules/@material-ui/icons/esm/SyncAlt.js"),g=n("./node_modules/@material-ui/core/esm/Box/Box.js"),b=n("./node_modules/@material-ui/core/esm/withWidth/withWidth.js"),w=n("./node_modules/react/index.js"),v=n("./node_modules/prop-types/index.js"),x=n.n(v),S=n("./src/common/components/withWallet/index.js"),Z=n("./node_modules/@material-ui/core/esm/styles/withStyles.js"),E=n("./src/constants/mints.js"),C=n("./node_modules/react-redux/es/index.js"),j=n("./src/pages/Swap/selector.js"),k=n("./src/common/components/Loading/index.js"),_=n("./src/pages/Swap/CurrencySelector/index.js"),R=n("./src/actions/account.js"),A=n("./src/common/components/Icons/IconSwapDownArrow.js"),P=n("./node_modules/bignumber.js/bignumber.js"),I=n.n(P),T=n("./src/common/components/Icons/IconSwapHorizontal.js"),B=n("./src/actions/swap.js"),V=n("./src/common/components/AutoRefreshButton/index.js"),D=n("./src/common/utils/displayPrice.js"),N=n("./src/common/utils/swap.js"),M=n("./node_modules/lodash/lodash.js"),L=n("./src/constants/swap.js"),O=n("./src/pages/Swap/SettingsModal/index.js"),z=n("./src/common/components/ConfirmationHelpers/Swap.js"),F=n("./src/actions/stakingDefi.js"),W=n("./src/common/utils/swapPrice.js"),H=n("./src/pages/Swap/Progress/index.js");function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function q(e,t,n,r,a,s,o){try{var i=e[s](o),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function K(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var s=e.apply(t,n);function o(e){q(s,r,a,o,i,"next",e)}function i(e){q(s,r,a,o,i,"throw",e)}o(void 0)}))}}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e,t){return G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},G(e,t)}function Q(e,t){if(t&&("object"===$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Y(e)}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=(0,n("./node_modules/react-i18next/dist/es/withTranslation.js").Z)()(r=(0,b.ZP)()(r=(0,Z.Z)((function(e){return{iconSwapDownArrow:ee({height:36,width:36},e.breakpoints.down("xs"),{width:24,height:24}),switchPriceIcon:{width:16,height:16,marginLeft:4},helpIcon:{cursor:"pointer",marginLeft:4,fontSize:15,"&:hover":{color:e.palette.primary.main}},shade:{opacity:.4},progressRoot:{background:e.palette.common.white20,height:10,borderRadius:5},progressBar:{borderRadius:5},switchPrice:{cursor:"pointer"}}}))(r=(0,S.a)()(r=(0,C.$j)(j.Z,{getWalletData:R.zE,getRaydiumAmmAccounts:B.Qi,getSwapTokenAccounts:B.P_,swapRaydiumDirect:B.uo,swapRaydiumTransitive:B.Sb,getRaydiumPools:B.bY,getAggregateStakeAccount:F.E6})((a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&G(e,t)}(v,e);var t,n,r,a,b=(r=v,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=J(r);if(a){var n=J(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Q(this,e)});function v(){var e;U(this,v);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ee(Y(e=b.call.apply(b,[this].concat(n))),"state",{sourceCurrency:E.Xz,sourceValue:"",destinationCurrency:"",destinationValue:"",error:null,routes:null,pools:[],ammAccountsByPoolId:{},bestRoute:null,swapTokenAccounts:null,switchPriceSide:!1,slippage:"0.5",stakedSlrs:0,isLoading:!1,isSwapping:!1}),ee(Y(e),"fetchAggregateStakeAccount",K(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.getAggregateStakeAccount({wallet:e.props.wallet});case 2:(n=t.sent)?(r=new(I())(n.totalStake).div(Math.pow(10,6)).toNumber(),e.setState({stakedSlrs:r})):e.setState({stakedSlrs:0});case 4:case"end":return t.stop()}}),t)})))),ee(Y(e),"findRoutes",K(regeneratorRuntime.mark((function t(){var n,r,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.sourceCurrency&&e.state.destinationCurrency){t.next=2;break}return t.abrupt("return");case 2:return e.setState({isLoading:!0}),t.prev=3,n=(0,N.Il)({source:e.state.sourceCurrency,destination:e.state.destinationCurrency,raydiumPools:e.props.pools,currenciesByMint:e.props.currenciesByMint}),r=n.routes,a=n.pools,t.next=7,e.props.getRaydiumAmmAccounts({pools:a});case 7:return s=t.sent,t.next=10,new Promise((function(t){e.setState({routes:r,pools:a,ammAccountsByPoolId:s},t)}));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),console.log(t.t0);case 15:return t.prev=15,e.setState({isLoading:!1}),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[3,12,15,18]])})))),ee(Y(e),"swapTokenAccounts",K(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.state.bestRoute){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.props.getSwapTokenAccounts({route:e.state.bestRoute,walletPubkey:e.props.wallet.getPublicKey()});case 4:n=t.sent,e.setState({swapTokenAccounts:n});case 6:case"end":return t.stop()}}),t)})))),ee(Y(e),"canSwap",(function(){var t;if(!e.state.sourceCurrency||!parseFloat(e.state.sourceValue))return!1;if(!e.state.destinationCurrency||!parseFloat(e.state.destinationValue))return!1;if(!e.state.sourceCurrency||!parseFloat(e.state.sourceValue))return!1;if(!e.state.bestRoute)return!1;if(!e.state.swapTokenAccounts)return!1;var n,r=new(I())(e.state.sourceValue).times(Math.pow(10,e.state.bestRoute.fromToken.decimals)).dp(0,I().ROUND_FLOOR);if(e.state.bestRoute.fromToken.mintAddress===E.BH){if(r.isGreaterThan((null===(n=e.props.currenciesByMint[E.BH])||void 0===n?void 0:n.amount)||0))return!1}else if(r.isGreaterThan((null===(t=e.props.currenciesByMint[e.state.sourceCurrency])||void 0===t?void 0:t.amount)||0))return!1;return!0})),ee(Y(e),"swapTokenAccountsDebounced",(0,M.debounce)(e.swapTokenAccounts,500)),ee(Y(e),"handleSourceCurrencyChange",(function(t){e.setState({sourceCurrency:t,destinationCurrency:t===e.state.destinationCurrency?"":e.state.destinationCurrency,sourceValue:"",destinationValue:"",routes:null,bestRoute:null,swapTokenAccounts:null})})),ee(Y(e),"handleDestinationCurrencyChange",(function(t){e.setState({destinationCurrency:t,sourceCurrency:t===e.state.sourceCurrency?"":e.state.sourceCurrency,sourceValue:"",destinationValue:"",routes:null,bestRoute:null,swapTokenAccounts:null})})),ee(Y(e),"switchCurrencies",(function(){e.setState({sourceCurrency:e.state.destinationCurrency,destinationCurrency:e.state.sourceCurrency,sourceValue:"",destinationValue:"",bestRoute:null,swapTokenAccounts:null})})),ee(Y(e),"handleSourceValueChange",(function(t){var n;if(t)if(e.state.sourceCurrency&&e.state.destinationCurrency){var r=new(I())(t).times(Math.pow(10,(null===(n=e.props.currenciesByMint[e.state.sourceCurrency])||void 0===n?void 0:n.decimals)||0)).dp(0,I().ROUND_FLOOR).toString(),a=(0,N.g7)({fromAmount:r,stakedSlrs:e.state.stakedSlrs,routes:e.state.routes||[],ammAccountsByPoolId:e.state.ammAccountsByPoolId,currenciesByMint:e.props.currenciesByMint,sourceCurrency:e.state.sourceCurrency,destinationCurrency:e.state.destinationCurrency});e.setState({sourceValue:"".concat(t),destinationValue:(null==a?void 0:a.toUiAmount)||"",bestRoute:a},e.swapTokenAccountsDebounced)}else e.setState({sourceValue:t,destinationValue:"",bestRoute:null,swapTokenAccounts:null});else e.setState({sourceValue:"",destinationValue:"",bestRoute:null,swapTokenAccounts:null})})),ee(Y(e),"handleSourceValuePreset",(function(t){var n=e.props.currenciesByMint[e.state.sourceCurrency],r=(null==n?void 0:n.uiAmount)||0;e.handleSourceValueChange(new(I())(r).times(t).dp((null==n?void 0:n.decimals)||0),I().ROUND_FLOOR)})),ee(Y(e),"handleRefresh",K(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.getWalletData(e.props.wallet.getPublicKey());case 2:return t.next=4,e.findRoutes();case 4:e.handleSourceValueChange(e.state.sourceValue);case 5:case"end":return t.stop()}}),t)})))),ee(Y(e),"switchPrice",(function(){e.setState((function(e){return{switchPriceSide:!e.switchPriceSide}}))})),ee(Y(e),"handleChangeSlippage",(function(t){var n=parseFloat(t);isNaN(n)||e.setState({slippage:"".concat(n)})})),ee(Y(e),"handleSwapDirect",K(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({isSwapping:!0}),e.props.swapRaydiumDirect({sign:e.props.wallet.sign,wallet:e.props.wallet,route:e.state.bestRoute,tokenAccounts:e.state.swapTokenAccounts,fromAmount:e.state.sourceValue,toAmount:e.state.destinationValue,slippage:e.state.slippage,confirmData:w.createElement(z.Z,{route:e.state.bestRoute,tokenAccounts:e.state.swapTokenAccounts,currenciesByMint:e.props.currenciesByMint,slippage:e.state.slippage,fromAmount:e.state.sourceValue,toAmount:e.state.destinationValue}),onConfirm:function(){e.handleSourceValueChange(""),e.props.getWalletData(e.props.wallet.getPublicKey()),e.setState({isSwapping:!1})},onError:function(){e.setState({isSwapping:!1})}});case 2:case"end":return t.stop()}}),t)})))),ee(Y(e),"handleSwapTransitive",K(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({isSwapping:!0}),e.props.swapRaydiumTransitive({signAll:e.props.wallet.signAll,wallet:e.props.wallet,route:e.state.bestRoute,tokenAccounts:e.state.swapTokenAccounts,fromAmount:e.state.sourceValue,toAmount:e.state.destinationValue,slippage:e.state.slippage,commitment:"confirmed",confirmData:w.createElement(z.Z,{route:e.state.bestRoute,tokenAccounts:e.state.swapTokenAccounts,currenciesByMint:e.props.currenciesByMint,slippage:e.state.slippage,fromAmount:e.state.sourceValue,toAmount:e.state.destinationValue}),onConfirm:function(){e.handleSourceValueChange(""),e.props.getWalletData(e.props.wallet.getPublicKey()),e.setState({isSwapping:!1})},onError:function(){e.setState({isSwapping:!1})}});case 2:case"end":return t.stop()}}),t)})))),ee(Y(e),"handleSwap",K(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((null===(n=e.state.bestRoute)||void 0===n?void 0:n.type)!==L.ob){t.next=6;break}return t.next=3,e.handleSwapDirect();case 3:case 8:return t.abrupt("return",t.sent);case 6:return t.next=8,e.handleSwapTransitive();case 9:case"end":return t.stop()}}),t)})))),e}return t=v,(n=[{key:"componentDidMount",value:function(){this.props.getRaydiumPools(),this.props.getWalletData(this.props.wallet.getPublicKey()),this.fetchAggregateStakeAccount()}},{key:"componentDidUpdate",value:function(e,t){t.sourceCurrency===this.state.sourceCurrency&&t.destinationCurrency===this.state.destinationCurrency||this.findRoutes()}},{key:"renderPriceImpact",value:function(){var e;if(null===(e=this.state.bestRoute)||void 0===e||!e.impact||this.state.isLoading)return w.createElement("span",{className:this.props.classes.shade},"N/A");var t=this.state.bestRoute.impact>=.01?(0,D.E)({amount:this.state.bestRoute.impact,displayType:"medium",suffix:"%"}):"< 0.01%";return this.state.bestRoute.impact>5?w.createElement(g.Z,{component:"span",color:"error.main",fontWeight:"fontWeightBold"},t):this.state.bestRoute.impact>1?w.createElement(g.Z,{component:"span",color:"warning.main",fontWeight:"fontWeightBold"},t):t}},{key:"renderPriceLine",value:function(){var e=this.props.classes;if(this.state.bestRoute&&parseFloat(this.state.sourceValue)>0&&parseFloat(this.state.destinationValue)>0){var t=new(I())(this.state.destinationValue).div(this.state.sourceValue).dp(6).toString();return w.createElement(g.Z,{display:"flex",alignItems:"center",flexDirection:"row",className:e.switchPrice,onClick:this.switchPrice},(0,D.E)({amount:this.state.switchPriceSide?1/t:t,displayType:"long"})," ",this.state.switchPriceSide?"".concat(this.state.bestRoute.fromToken.symbol," per ").concat(this.state.bestRoute.toToken.symbol):"".concat(this.state.bestRoute.toToken.symbol," per ").concat(this.state.bestRoute.fromToken.symbol),w.createElement(h.Z,{className:e.switchPriceIcon}))}return w.createElement("span",{className:e.shade},"N/A")}},{key:"renderSwapButtons",value:function(){var e=this.props.t;return this.state.sourceCurrency&&this.state.destinationCurrency&&null!==this.state.routes&&!this.state.routes.length?w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"center"},w.createElement(f.Z,{variant:"contained",startIcon:w.createElement(y.Z,null),disabled:!0,size:"small"},e("swap_pool_not_found"))):this.canSwap()?w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"center"},w.createElement(f.Z,{variant:"contained",startIcon:w.createElement(T.X,null),onClick:this.handleSwap,size:"small"},e("action_swap"))):w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"center"},w.createElement(f.Z,{variant:"contained",startIcon:w.createElement(T.X,null),disabled:!0,size:"small"},e("action_swap")))}},{key:"render",value:function(){var e=this,t=this.props,n=t.network,r=t.classes,a=t.pools,f=t.currencies,y=t.currenciesByMint,h=t.width,b=t.t;if("mainnet"!==n.cluster)return w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"center"},w.createElement(d.Z,{variant:"h3"},b("swap_mainnet_only")));var v=0===a.length||0===f.length||this.state.isLoading||this.state.isSwapping,x="xs"===h,S=(0,W.gR)(this.state.stakedSlrs);return w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"center",pb:{xs:0,sm:2}},w.createElement(g.Z,{width:"100%",maxWidth:430,position:"relative"},w.createElement(g.Z,{clone:!0,p:{xs:"20px 30px !important",sm:"30px !important"}},w.createElement(s.Z,{elevation:2},w.createElement(g.Z,{className:"js-theme-snow-roof"}),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",pb:{xs:1,sm:2}},w.createElement(d.Z,{variant:"body2"},b("swap_title")),w.createElement(g.Z,{display:"flex",alignItems:"center"},w.createElement(V.Z,{onRefresh:this.handleRefresh,interval:60,key:"".concat(this.state.sourceCurrency,"-").concat(this.state.destinationCurrency)}),w.createElement(O.Z,{slippage:this.state.slippage,onChange:this.handleChangeSlippage}))),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",pb:{xs:2,sm:3}},w.createElement(g.Z,{width:"calc(40% - 8px)"},w.createElement(_.Z,{value:this.state.sourceCurrency,onChange:this.handleSourceCurrencyChange,currencies:f,currenciesByMint:y,isLoading:v})),w.createElement(g.Z,{width:"calc(60% - 8px)"},w.createElement(u.Z,{fullWidth:!0,readOnly:v,variant:"outlined",placeholder:"0.0",name:"sourceValue",type:"number",pattern:"^[0-9]*[.,]?[0-9]*$",value:this.state.sourceValue,onChange:function(t){return e.handleSourceValueChange(t.target.value.trim())},InputProps:{endAdornment:w.createElement(m.Z,{position:"end"},w.createElement(p.Z,{className:r.buttonMaxAmount,onClick:function(){return e.handleSourceValuePreset(1)}},b("max")))}}))),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between"},w.createElement(g.Z,{flexGrow:1},w.createElement(l.Z,{light:!0})),w.createElement(g.Z,{p:{xs:0,sm:1},px:{xs:1,sm:0}},w.createElement(g.Z,{clone:!0,p:{xs:0,sm:1.5}},w.createElement(c.Z,{color:"primary",onClick:this.switchCurrencies},w.createElement(A.t,{className:r.iconSwapDownArrow})))),w.createElement(g.Z,{flexGrow:1},w.createElement(l.Z,{light:!0}))),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",pb:{xs:1,sm:2}},w.createElement(d.Z,{variant:"body2"},b("swap_for_estimated"))),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between"},w.createElement(g.Z,{width:"calc(40% - 8px)"},w.createElement(_.Z,{value:this.state.destinationCurrency,onChange:this.handleDestinationCurrencyChange,currencies:f,currenciesByMint:y,isLoading:v})),w.createElement(g.Z,{width:"calc(60% - 8px)"},w.createElement(u.Z,{fullWidth:!0,variant:"outlined",placeholder:"0.0",name:"destinationValue",type:"number",InputProps:{readOnly:!0},inputProps:{style:{cursor:"not-allowed"}},value:this.state.destinationValue}))),w.createElement(g.Z,{my:{xs:1.5,sm:3}},w.createElement(l.Z,{light:!0})),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:{xs:.5,sm:2}},w.createElement(d.Z,{variant:x?"subtitle2":"body2",component:"div"},w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"flex-start"},b("swap_rate"),w.createElement(o.ZP,{placement:"top",title:w.createElement(w.Fragment,null,0===S?w.createElement(d.Z,{variant:"body2",gutterBottom:!0},b("swap_rate_no_fee")):w.createElement(d.Z,{variant:"body2",gutterBottom:!0},b("swap_rate_fee",{fee:new(I())(S).dp(2).toString()})))},w.createElement(i.Z,{className:r.helpIcon,fontSize:"inherit"})))),w.createElement(d.Z,{variant:x?"subtitle2":"body2",component:"div"},this.renderPriceLine())),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:{xs:.5,sm:2}},w.createElement(d.Z,{variant:x?"subtitle2":"body2",component:"div"},w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"flex-start"},b("swap_slippage"),w.createElement(o.ZP,{placement:"top",title:w.createElement(w.Fragment,null,w.createElement(d.Z,{variant:"body2"},b("swap_slippage_tooltip")))},w.createElement(i.Z,{className:r.helpIcon,fontSize:"inherit"})))),w.createElement(d.Z,{variant:x?"subtitle2":"body2"},this.state.slippage,"%")),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:{xs:.5,sm:2}},w.createElement(d.Z,{variant:x?"subtitle2":"body2",component:"div"},w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"flex-start"},b("swap_minimum_received"),w.createElement(o.ZP,{placement:"top",title:w.createElement(w.Fragment,null,w.createElement(d.Z,{variant:"body2"},b("swap_minimum_received_tooltip")))},w.createElement(i.Z,{className:r.helpIcon,fontSize:"inherit"})))),w.createElement(d.Z,{variant:x?"subtitle2":"body2"},parseFloat(this.state.destinationValue)>0&&this.state.bestRoute?w.createElement(w.Fragment,null,new(I())(this.state.destinationValue).times((100-parseFloat(this.state.slippage))/100).dp(this.state.bestRoute.toToken.decimals).toString()," ",this.state.bestRoute.toToken.symbol):w.createElement("span",{className:r.shade},"N/A"))),w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:{xs:.5,sm:2}},w.createElement(d.Z,{variant:x?"subtitle2":"body2",component:"div"},w.createElement(g.Z,{display:"flex",alignItems:"center",justifyContent:"flex-start"},b("swap_price_impact"),w.createElement(o.ZP,{placement:"top",title:w.createElement(w.Fragment,null,w.createElement(d.Z,{variant:"body2"},b("swap_price_impact_tooltip")))},w.createElement(i.Z,{className:r.helpIcon,fontSize:"inherit"})))),w.createElement(d.Z,{variant:x?"subtitle2":"body2"},this.renderPriceImpact())),w.createElement(H.Z,{stakedSlrs:this.state.stakedSlrs,isSmall:x}),w.createElement(g.Z,{my:{xs:1.5,sm:3}},w.createElement(l.Z,{light:!0})),this.renderSwapButtons())),w.createElement(k.Z,{open:v})))}}])&&X(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),v}(w.Component),ee(a,"propTypes",{t:x().func,width:x().string,wallet:x().object,network:x().object,classes:x().object,pools:x().array,currenciesByMint:x().object,currencies:x().array,getWalletData:x().func,getRaydiumPools:x().func,swapRaydiumDirect:x().func,swapRaydiumTransitive:x().func,getRaydiumAmmAccounts:x().func,getSwapTokenAccounts:x().func,getAggregateStakeAccount:x().func}),r=a))||r)||r)||r)||r)||r}}]);